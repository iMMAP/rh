{% extends "project_reports/forms/monthly_report_form_base.html" %}
{% load static %}
{% load compress %}


{% block report_body %}
<div class="content-block top-border">
    <div class="project-title">
        <div class="holder">
            <strong class="h5">{{ report_form.instance.report_date | date:"F Y" }}</strong>
            <ul class="buttons-list-inline">
                <li>
                    <a href="#" class="btn btn-gray">
                        <span class="btn-text">Delete</span>
                        <span class="icon-trashbin-outline"></span>
                    </a>
                </li>
            </ul>
        </div>
    </div>
	<form method="post" enctype="multipart/form-data" id="activity-formset-form">
		{% comment %} Monthly Reporting Date {% endcomment %}
		<div class="monthly-reporting">
			<div class="row">
				<div class="col">
					<div class="report-date-picker-field">
						<div class="date start">
							<label for="{{ report_form.report_date.id_for_label }}">Report Date</label>
							{{ report_form.report_date }}
							{{ report_form.state }}
							{{ report_form.project }}
							{{ report_form.active }}
						</div>
					</div>
				</div>
			</div>
		</div>

		{% comment %} Monthly Reporting Activities against Locations and Indicators {% endcomment %}
		<div class="location-block-holder">
			<div class="block-top-title report-title">
				<div class="title">
					Reporting Activities
				</div>
			</div>
		</div>
		{{ activity_report_formset.management_form }} 
		
		{% csrf_token %}

		{% for activity_report_form, location_report_formset in combined_formset %}
		<div class="monthly-progress monthly-accordion create-report">
			<div class="inner-holder">
				<a href="#" class="block-top monthly-accordion-opener">
					<span class="title">
						<span class="tooltip-info icon-info" data-tippy-content="Lorem lorem lorem"></span>
						{% if activity_report_form.instance.pk %}
							{{ activity_report_form.instance.activity_plan }}
						{% else %}
							{{ activity_report_form.initial.activity_plan }}
						{% endif %}
						{{ activity_report_form.activity_plan }}
						{{ activity_report_form.id }}
					</span>
					<span class="people">
						<span class="icon-group"></span>
						1657
					</span>
				</a>
				<div class="monthly-accordion-slide">
					<div class="row">
						<div class="col">
							<div class="multiple-fields-row two-items">
								<div class="field-col">
									<div class="select-field">
										<span class="label">Activity Domain</span>
										<span class="text-read-only">
											{% if activity_report_form.instance.pk %}
												{{ activity_report_form.instance.activity_plan.activity_domain.name }}
											{% else %}
												{{ activity_report_form.initial.activity_plan.activity_domain.name }}
											{% endif %}
										</span>
									</div>
								</div>
								<div class="field-col">
									<div class="select-field">
										<span class="label">Activity Type</span>
										<span class="text-read-only">
											{% if activity_report_form.instance.pk %}
												{{ activity_report_form.instance.activity_plan.activity_type.name }}
											{% else %}
												{{ activity_report_form.initial.activity_plan.activity_type.name }}
											{% endif %}
										</span>
									</div>
								</div>
							</div>
						</div>
						{% if activity_report_form.instance.activity_plan.activity_detail or activity_report_form.initial.activity_plan.activity_detail %}
							<div class="col">
								<div class="field-col">
									<div class="select-field">
										<span class="label">Activity Details</span>
										<span class="text-read-only">
											{% if activity_report_form.instance.pk %}
												{{ activity_report_form.instance.activity_plan.activity_detail.name }}
											{% else %}
												{{ activity_report_form.initial.activity_plan.activity_detail.name }}
											{% endif %}
										</span>
									</div>
								</div>
							</div>
						{% endif %}
						<div class="col">
							<div class="field-col">
								<div class="select-field">
									<label>Indicator</label>
									{{ activity_report_form.indicator }}
								</div>
							</div>
						</div>
					</div>

					<div class="row monthly-reporting" id="report_locations-{{activity_report_form.prefix}}">
						<div class="col col-lg">
							<div class="target-location-block target-location-accordion">
								<div class="inner-holder">
									<div class="add_button">
										<button data-form-prefix="{{activity_report_form.prefix}}" data-project="{{ project.pk }}" type="button"
												class="btn btn-red add-target-location-form-button">Add Location Report
										</button>
									</div>
									<div class="block-top target-location-accordion-opener">
										<div class="location-block-holder">
											<div class="block-top-title">
												<div class="title">
													Reporting Targeted Locations
												</div>
											</div>
										</div>
									</div>
									<div class="target-location-accordion-slide">
										{{ location_report_formset.management_form }}
										<div id="{{ activity_report_form.prefix }}">
											{% for location_report_form in location_report_formset %}
												{% include "project_reports/forms/location_report_empty_form.html" with location_report_form=location_report_form %}
											{% endfor %}
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
		{% endfor %}

		{% comment %} Monthly Report Description and Files Upload {% endcomment %}
		<div class="monthly-reporting">
			<div class="row">
				<div class="col">
					<div class="input-field">
						<label for="{{ report_form.description.id_for_label}}">Description &amp; Objectives</label>
						<div class="input-holder">{{ report_form.description }}</div>
					</div>
				</div>
			</div>
		</div>

		<div class="monthly-progress-submit-holder text-center">
			<button type="submit" class="btn btn-red">Save</button>
		</div>
	</form>
</div>

{{ activity_plan_formset.media.js }}
{% compress js %}
	<script defer src="{% static 'project_reports/js/monthly_report_progress.js' %}"></script>
{% endcompress js %}

{% endblock report_body %}