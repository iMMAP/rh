{% extends "_base.html" %}

{% load static %}
{% load humanize %}

{% block title %}
    ReportHub - Home
{% endblock title %}

{% block head %}
{% endblock head %}

{% block breadcrumb_li %}
    <li class="current">
        {{ request.resolver_match.kwargs.cluster|capfirst }}'s Home
    </li>
{% endblock %}

{% block content %}
    <section class="visual-map-section main-map active-sidebar">
        <div class="container">
            {% comment %}  {% endcomment %}
            <div class="projects-options-panel">
                <div class="holder">
                    <h1 class="locations text-red-be"> {{ request.resolver_match.kwargs.cluster|capfirst }}'s Home </h1>
                    <ul class="buttons-list-inline">
                        <li>
                            {% if request.resolver_match.kwargs.cluster %}
                                <a href="{% url 'cluster-projects-list' request.resolver_match.kwargs.cluster %}" class="btn btn-gray-outline" >Projects</a>
                            {% endif %}
                        </li>
                         <li> 
                            {% if request.resolver_match.kwargs.cluster %}
                                <a class="btn btn-red" href="{% url 'clusters-5w' request.resolver_match.kwargs.cluster %}">{{ request.resolver_match.kwargs.cluster|capfirst }} 5W Dashboard</a>
                            {% endif %}
                        </li> 
                    </ul>
                </div>
                <p class="py-4 flex items-center gap-2">
                    This page provides an overview of your organization's current projects, pending reports, and a visual map of your activities.
                </p>
            </div>
            {% comment %}  {% endcomment %}

            <div class="flex flex-col gap-6 w-full">
                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 ">
                    <div class="rounded-lg shadow-sm p-6 border border-gray-d1">
                        <div class="flex items-center justify-between">
                            <div class="flex items-center gap-4">
                                <div class="bg-muted rounded-full p-2">
                                    <svg xmlns="http://www.w3.org/2000/svg"
                                         fill="none"
                                         viewBox="0 0 24 24"
                                         stroke-width="1.5"
                                         stroke="currentColor"
                                         class="size-6">
                                        <path stroke-linecap="round" stroke-linejoin="round" d="M9 12h3.75M9 15h3.75M9 18h3.75m3 .75H18a2.25 2.25 0 0 0 2.25-2.25V6.108c0-1.135-.845-2.098-1.976-2.192a48.424 48.424 0 0 0-1.123-.08m-5.801 0c-.065.21-.1.433-.1.664 0 .414.336.75.75.75h4.5a.75.75 0 0 0 .75-.75 2.25 2.25 0 0 0-.1-.664m-5.8 0A2.251 2.251 0 0 1 13.5 2.25H15c1.012 0 1.867.668 2.15 1.586m-5.8 0c-.376.023-.75.05-1.124.08C9.095 4.01 8.25 4.973 8.25 6.108V8.25m0 0H4.875c-.621 0-1.125.504-1.125 1.125v11.25c0 .621.504 1.125 1.125 1.125h9.75c.621 0 1.125-.504 1.125-1.125V9.375c0-.621-.504-1.125-1.125-1.125H8.25ZM6.75 12h.008v.008H6.75V12Zm0 3h.008v.008H6.75V15Zm0 3h.008v.008H6.75V18Z" />
                                    </svg>
                                </div>
                                <div>
                                    <p class="text-sm text-muted-foreground">Activity Plans</p>
                                    <p class="text-2xl font-bold">{{ counts.activity_plans_count|intcomma }}</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="rounded-lg shadow-sm p-6 border border-gray-d1">
                        <div class="flex items-center justify-between">
                            <div class="flex items-center gap-4">
                                <div class="bg-muted rounded-full p-2">
                                    <svg xmlns="http://www.w3.org/2000/svg"
                                         fill="none"
                                         viewBox="0 0 24 24"
                                         stroke-width="1.5"
                                         stroke="currentColor"
                                         class="size-6">
                                        <path stroke-linecap="round" stroke-linejoin="round" d="M15 10.5a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z" />
                                        <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1 1 15 0Z" />
                                    </svg>
                                </div>
                                <div>
                                    <p class="text-sm text-muted-foreground">Targeted District</p>
                                    <p class="text-2xl font-bold">{{ counts.target_locations_count|intcomma }}</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="rounded-lg shadow-sm p-6 border border-gray-d1">
                        <div class="flex items-center justify-between">
                            <div class="flex items-center gap-4">
                                <div class="bg-muted rounded-full p-2">
                                    <svg xmlns="http://www.w3.org/2000/svg"
                                         fill="none"
                                         viewBox="0 0 24 24"
                                         stroke-width="1.5"
                                         stroke="currentColor"
                                         class="size-6">
                                        <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 21h16.5M4.5 3h15M5.25 3v18m13.5-18v18M9 6.75h1.5m-1.5 3h1.5m-1.5 3h1.5m3-6H15m-1.5 3H15m-1.5 3H15M9 21v-3.375c0-.621.504-1.125 1.125-1.125h3.75c.621 0 1.125.504 1.125 1.125V21" />
                                    </svg>
                                </div>
                                <div>
                                    <p class="text-sm text-muted-foreground">Implementing Partners</p>
                                    <p class="text-2xl font-bold">{{ counts.implementing_partners_count|intcomma }}</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="rounded-lg shadow-sm p-6 border border-gray-d1">
                        <div class="flex items-center justify-between">
                            <div class="flex items-center gap-4">
                                <div class="bg-muted rounded-full p-2">
                                    <svg xmlns="http://www.w3.org/2000/svg"
                                         fill="none"
                                         viewBox="0 0 24 24"
                                         stroke-width="1.5"
                                         stroke="currentColor"
                                         class="size-6">
                                        <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 3v11.25A2.25 2.25 0 0 0 6 16.5h2.25M3.75 3h-1.5m1.5 0h16.5m0 0h1.5m-1.5 0v11.25A2.25 2.25 0 0 1 18 16.5h-2.25m-7.5 0h7.5m-7.5 0-1 3m8.5-3 1 3m0 0 .5 1.5m-.5-1.5h-9.5m0 0-.5 1.5m.75-9 3-3 2.148 2.148A12.061 12.061 0 0 1 16.5 7.605" />
                                    </svg>
                                </div>
                                <div>
                                    <p class="text-sm ">Pending Reports</p>
                                    <p class="text-2xl font-bold">{{ counts.pending_reports_count|intcomma }}</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-4">
                    <div class="rounded-lg shadow-sm p-6 border border-gray-d1">
                        <div class="flex items-center justify-between pb-4 border-b border-gray-e6">
                            <h3 class="text-lg font-medium">Active Projects</h3>
                            <a href="{% url 'cluster-projects-list' request.resolver_match.kwargs.cluster %}?state=in-progress" class="btn btn-gray-outline">View All</a>
                        </div>
                        <div class="mt-4">
                            <div class="relative w-full ">
                                {% if active_projects|length != 0 %}
                                <table class="w-full caption-bottom overflow-auto text-sm">
                                    <thead class="">
                                        <tr class="hover:bg-muted/50 font-bold">
                                            <th class="h-12 text-left align-middle ">Title</th>
                                            <th class="h-12 text-left align-middle ">End Date</th>
                                            <th class="h-12 text-left align-middle ">Links</th>
                                        </tr>
                                    </thead>
                                    <tbody class="">
                                        {% for project in active_projects %}
                                            <tr class="border border-gray-e6 hover:bg-muted/50 ">
                                                <td class="py-3 align-middle ">
                                                    <a class="" href="{% url 'projects-detail' project.id %}">{{ project.title }} ({{ project.code }})</a>
                                                </td>
                                                <td class="py-3 align-middle">{{ project.end_date|date:"d/m/Y" }}</td>
                                                <td class="py-3 align-middle text-right">
                                                    <a href="{% url 'project_reports_home' project.pk %}"
                                                       class="font-medium border border-gray-d1 px-2 rounded">Reports</a>
                                                </td>
                                            </tr>
                                        {% endfor %}
                                    </tbody>
                                </table>
                                {% else %}
                                    <p class="text-center">No data yet!</p>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                    <div class="rounded-lg shadow-sm p-6 border border-gray-d1">
                        <div class="flex items-center justify-between pb-4 border-b border-gray-e6">
                            <h3 class="text-lg font-medium">Pending Reports</h3>
                             {% comment %} <a href="{% url 'organizations-5w' user.profile.organization %}" class="btn btn-gray-outline"> all pending reports {% endcomment %}
                            </a>
                        </div>
                        <div class="mt-4">
                            <div class="relative w-full overflow-auto">
                                {% if pending_reports|length != 0 %}
                                <table class="w-full caption-bottom text-sm">
                                    <thead class="">
                                        <tr class="border-b border-gray-e6 hover:bg-muted/50 font-bold">
                                            <th class="h-12 text-left align-middle ">Report</th>
                                            <th class="h-12 text-left align-middle ">Project</th>
                                            <th class="h-12 text-left align-middle ">Focal Point</th>
                                            <th class="h-12 text-left align-middle ">Status</th>
                                        </tr>
                                    </thead>
                                    <tbody class="">
                                        {% for report in pending_reports %}
                                            <tr class="border-b border-gray-e6 hover:bg-muted/50 ">
                                                <td class="py-3 align-middle  font-medium">
                                                    <a class=""
                                                       href="{% url 'view_monthly_report' report.project.id report.id %}">
                                                        {{ report }}
                                                    </td>
                                                </a>
                                                <td class="py-3 align-middle ">
                                                    <a href="{% url 'projects-detail' report.project.id %}">{{ report.project.code }}</a>
                                                </td>
                                                <td class="py-3 align-middle ">
                                                    <a href="{% url 'profiles-show' report.project.user.username %}"> {{ report.project.user }} </a>
                                                </td>
                                                <td class="py-3 align-middle ">
                                                    <div class="{{ report.state }}">{{ report.get_state_display }}</div>
                                                </td>
                                            </tr>
                                        {% endfor %}
                                    </tbody>
                                </table>
                                {% else %}
                                    <p class="text-center">No data yet!</p>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
{% endblock content %}

{% block scripts %}
{% endblock scripts %}
